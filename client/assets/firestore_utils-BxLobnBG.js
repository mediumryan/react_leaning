import{n as i,E as d,j as r,k as c,w as f,x as p,s as y,y as w,z as h,l as m,C as R,D as A,v as F}from"./button-CAZCDkQr.js";const U=async t=>{const s=r(c,"users",t),o=await F(s);if(o.exists()){const a=o.data(),e=i(s,"contentStatus"),n=await d(e),u=new Set(n.docs.map(l=>l.id));return{uid:t,...a,contentStatus:u}}else return console.error("No user profile found in Firestore for UID:",t),null},g=async()=>{const t=i(c,"users"),s=await d(t),o=[];for(const a of s.docs){const e=a.data(),n=a.id,u=i(a.ref,"contentStatus"),l=await d(u),S=new Set(l.docs.map(D=>D.id));o.push({uid:n,...e,contentStatus:S})}return o},C=async t=>{const s=r(c,"users",t.uid),{contentStatus:o,...a}=t;await y(s,a);const e=f(c);o.forEach(n=>{const u=r(s,"contentStatus",n);e.set(u,{createdAt:new Date})}),await e.commit()},I=async(t,s)=>{const o=r(c,"users",t),{contentStatus:a,...e}=s;await w(o,e)},q=async t=>{const s=r(c,"users",t),o=i(s,"contentStatus"),a=await d(o),e=f(c);a.docs.forEach(n=>{e.delete(n.ref)}),await e.commit(),await p(s)},T=async(t,s)=>{const o=r(c,"users",t);await w(o,{course:s})},b=async()=>{try{const t=i(c,"notices"),s=R(t,A("createdAt","desc"));return(await d(s)).docs.map(a=>{const e=a.data();return{id:a.id,title:e.title,content:e.content,createdAt:e.createdAt.toDate(),isNew:e.isNew??!1,isImportant:e.isImportant??!1}})}catch(t){return console.error("Failed to fetch notices:",t),[]}},x=async(t,s,o,a)=>{try{const e=i(c,"notices");await h(e,{title:t,content:s,isNew:o??!0,isImportant:a??!1,createdAt:m()})}catch(e){throw console.error("Failed to create notice:",e),e}},E=async t=>{const s=r(c,"notices",t);await p(s)};export{x as a,g as b,q as c,E as d,C as e,I as f,b as g,U as h,T as u};
