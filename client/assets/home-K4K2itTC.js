import{a as l,p as e,w as oe,q as ie,y as ce}from"./chunk-EPOLDU6W-K4piUF01.js";import{b as le,a as S,d as H,B as v,e as y,u as U,h as M,i as de,f as w}from"./button-BLTjC7jM.js";import{c as ue}from"./contentData-D89YquwA.js";import{B as $}from"./button-group-Br1cWe54.js";import"./index-HXCuKcVE.js";import{u as me,g as he,a as pe,d as xe}from"./firestore_utils-DDjvgd02.js";import{C as fe,a as ge,b as ve,c as je}from"./card-B9Oa5ilp.js";import{u as be,C as Ce,S as ke,F as Ne}from"./index-BkzzaYaH.js";import{D as q,a as ye,P as we,b as V,c as G,d as K,e as W,B as D}from"./dialog-Db-Y_fgG.js";import{b as Se,r as T,g as Re}from"./helper-CW-9vj9Q.js";import{L as P,I as Ie}from"./input-DCM0CQSc.js";import{T as Ee,c as C}from"./confirm-CVbgOPZP.js";import{c as Pe,a as Ae,e as _e,P as z,u as Te,d as F}from"./index-CtLNaDwg.js";import{u as ze}from"./index-HA0yNScu.js";import{B as Be}from"./BackgroundSpinner-DlrTYJNc.js";import{T as Le}from"./trash-2-DnUS3DfE.js";import{H as De,a as Fe}from"./commonStyle-CMqu6ffv.js";import{B as Oe,M as He}from"./messages-square-v3DVgfpw.js";import"./x-CZuTOl_8.js";const Ue=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Me=Pe("pencil",Ue);var $e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],qe=$e.reduce((t,r)=>{const s=le(`Primitive.${r}`),n=l.forwardRef((o,a)=>{const{asChild:i,...c}=o,u=i?s:r;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(u,{...c,ref:a})});return n.displayName=`Primitive.${r}`,{...t,[r]:n}},{}),Ve="Separator",O="horizontal",Ge=["horizontal","vertical"],Y=l.forwardRef((t,r)=>{const{decorative:s,orientation:n=O,...o}=t,a=Ke(n)?n:O,c=s?{role:"none"}:{"aria-orientation":a==="vertical"?a:void 0,role:"separator"};return e.jsx(qe.div,{"data-orientation":a,...c,...o,ref:r})});Y.displayName=Ve;function Ke(t){return Ge.includes(t)}var We=Y;function A({className:t,orientation:r="horizontal",decorative:s=!0,...n}){return e.jsx(We,{"data-slot":"separator",decorative:s,orientation:r,className:S("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",t),...n})}function Ye(){const[t,r]=H(y),s=["Beginner","Intermediate","Advanced"],[n,o]=l.useState(t?.course),a=async()=>{if(t&&confirm(`コースを「${n}」に変更しますか？`))try{await me(t.uid,n),r({...t,course:n}),alert("コースが変更されました")}catch(i){console.error("Failed to update course:",i),alert("コースの変更に失敗しました。")}};return e.jsxs(e.Fragment,{children:[e.jsx($,{orientation:"vertical",className:"my-4 gap-1",children:s.map((i,c)=>e.jsx(v,{variant:n===i?"default":"outline",onClick:()=>o(i),disabled:c===1||c===2,children:i==="Beginner"?"Beginner - 初心者コース":i==="Intermediate"?"Intermediate - 中級者コース（準備中）":"Advanced - 上級者コース（準備中）"},i))}),e.jsx(v,{variant:"ghost",onClick:a,disabled:!0,children:"変更"})]})}const Qe=Se(t=>({queryKey:["notice",t(T),t(y)],queryFn:async({queryKey:r})=>{const[,,s]=r;return s?await he():null}}));var R="Checkbox",[Xe]=Ae(R),[Je,B]=Xe(R);function Ze(t){const{__scopeCheckbox:r,checked:s,children:n,defaultChecked:o,disabled:a,form:i,name:c,onCheckedChange:u,required:x,value:f="on",internal_do_not_use_render:h}=t,[d,k]=Te({prop:s,defaultProp:o??!1,onChange:u,caller:R}),[j,b]=l.useState(null),[N,m]=l.useState(null),p=l.useRef(!1),I=j?!!i||!!j.closest("form"):!0,E={checked:d,disabled:a,setChecked:k,control:j,setControl:b,name:c,form:i,value:f,hasConsumerStoppedPropagationRef:p,required:x,defaultChecked:g(o)?!1:o,isFormControl:I,bubbleInput:N,setBubbleInput:m};return e.jsx(Je,{scope:r,...E,children:et(h)?h(E):n})}var Q="CheckboxTrigger",X=l.forwardRef(({__scopeCheckbox:t,onKeyDown:r,onClick:s,...n},o)=>{const{control:a,value:i,disabled:c,checked:u,required:x,setControl:f,setChecked:h,hasConsumerStoppedPropagationRef:d,isFormControl:k,bubbleInput:j}=B(Q,t),b=U(o,f),N=l.useRef(u);return l.useEffect(()=>{const m=a?.form;if(m){const p=()=>h(N.current);return m.addEventListener("reset",p),()=>m.removeEventListener("reset",p)}},[a,h]),e.jsx(z.button,{type:"button",role:"checkbox","aria-checked":g(u)?"mixed":u,"aria-required":x,"data-state":re(u),"data-disabled":c?"":void 0,disabled:c,value:i,...n,ref:b,onKeyDown:F(r,m=>{m.key==="Enter"&&m.preventDefault()}),onClick:F(s,m=>{h(p=>g(p)?!0:!p),j&&k&&(d.current=m.isPropagationStopped(),d.current||m.stopPropagation())})})});X.displayName=Q;var J=l.forwardRef((t,r)=>{const{__scopeCheckbox:s,name:n,checked:o,defaultChecked:a,required:i,disabled:c,value:u,onCheckedChange:x,form:f,...h}=t;return e.jsx(Ze,{__scopeCheckbox:s,checked:o,defaultChecked:a,disabled:c,required:i,onCheckedChange:x,name:n,form:f,value:u,internal_do_not_use_render:({isFormControl:d})=>e.jsxs(e.Fragment,{children:[e.jsx(X,{...h,ref:r,__scopeCheckbox:s}),d&&e.jsx(ae,{__scopeCheckbox:s})]})})});J.displayName=R;var Z="CheckboxIndicator",ee=l.forwardRef((t,r)=>{const{__scopeCheckbox:s,forceMount:n,...o}=t,a=B(Z,s);return e.jsx(_e,{present:n||g(a.checked)||a.checked===!0,children:e.jsx(z.span,{"data-state":re(a.checked),"data-disabled":a.disabled?"":void 0,...o,ref:r,style:{pointerEvents:"none",...t.style}})})});ee.displayName=Z;var te="CheckboxBubbleInput",ae=l.forwardRef(({__scopeCheckbox:t,...r},s)=>{const{control:n,hasConsumerStoppedPropagationRef:o,checked:a,defaultChecked:i,required:c,disabled:u,name:x,value:f,form:h,bubbleInput:d,setBubbleInput:k}=B(te,t),j=U(s,k),b=be(a),N=ze(n);l.useEffect(()=>{const p=d;if(!p)return;const I=window.HTMLInputElement.prototype,L=Object.getOwnPropertyDescriptor(I,"checked").set,se=!o.current;if(b!==a&&L){const ne=new Event("click",{bubbles:se});p.indeterminate=g(a),L.call(p,g(a)?!1:a),p.dispatchEvent(ne)}},[d,b,a,o]);const m=l.useRef(g(a)?!1:a);return e.jsx(z.input,{type:"checkbox","aria-hidden":!0,defaultChecked:i??m.current,required:c,disabled:u,name:x,value:f,form:h,...r,tabIndex:-1,ref:j,style:{...r.style,...N,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});ae.displayName=te;function et(t){return typeof t=="function"}function g(t){return t==="indeterminate"}function re(t){return g(t)?"indeterminate":t?"checked":"unchecked"}function tt({className:t,...r}){return e.jsx(J,{"data-slot":"checkbox",className:S("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...r,children:e.jsx(ee,{"data-slot":"checkbox-indicator",className:"grid place-content-center text-current transition-none",children:e.jsx(Ce,{className:"size-3.5"})})})}function at(){const[t,r]=l.useState(!1),[s,n]=l.useState(""),[o,a]=l.useState(""),[i,c]=l.useState(!1),[u,x]=l.useState(!1),f=M(T),h=async()=>{if(!s.trim()||!o.trim()){await C({icon:1,message:"タイトルと内容を入力してください。",size:"sm"});return}try{x(!0),await pe(s,o,!0,i),await C({icon:0,message:"お知らせが登録されました。",size:"sm"}),r(!1),n(""),a(""),c(!1),f(d=>d+1)}catch{await C({icon:2,message:"お知らせの登録に失敗しました。",size:"sm"})}finally{x(!1)}};return e.jsxs(q,{open:t,onOpenChange:r,children:[e.jsx(ye,{asChild:!0,children:e.jsx(v,{size:"sm",children:e.jsx(we,{className:"w-4 h-4"})})}),e.jsxs(V,{className:"sm:max-w-lg",children:[e.jsx(G,{children:e.jsx(K,{children:"공지사항 작성"})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{htmlFor:"title",children:"제목"}),e.jsx(Ie,{id:"title",value:s,onChange:d=>n(d.target.value),placeholder:"공지 제목을 입력하세요"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(P,{htmlFor:"content",children:"내용"}),e.jsx(Ee,{id:"content",value:o,onChange:d=>a(d.target.value),placeholder:"공지 내용을 입력하세요",rows:6})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tt,{id:"important",checked:i,onCheckedChange:d=>c(d===!0)}),e.jsx(P,{htmlFor:"important",children:"중요 공지"})]})]}),e.jsx(W,{children:e.jsx(v,{onClick:h,disabled:u,children:"등록"})})]})]})}const rt=de("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function st({className:t,variant:r,...s}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:S(rt({variant:r}),t),...s})}function nt({className:t,...r}){return e.jsx("div",{"data-slot":"alert-title",className:S("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",t),...r})}function ot({selectedNotice:t,setSelectedNotice:r}){const s=w(y),n=M(T),o=async()=>{if(!(!t||!await C({icon:1,message:"このお知らせを削除しますか？",size:"sm"})))try{await xe(t.id),await C({icon:1,message:"お知らせが削除されました。",size:"sm"}).then(()=>{}),await a(),r(null),n(c=>c+1)}catch{await C({icon:0,message:"お知らせの削除に失敗しました。",size:"sm"}).then(()=>{});return}},a=async()=>e.jsx(st,{children:e.jsx(nt,{children:"お知らせが削除されました。"})});return e.jsx(q,{open:!!t,onOpenChange:()=>r(null),children:e.jsx(V,{className:"max-w-lg",children:t&&e.jsxs(e.Fragment,{children:[e.jsx(G,{children:e.jsx(K,{children:t.title})}),e.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:t.createdAt.toLocaleDateString()}),e.jsx("div",{className:"whitespace-pre-wrap text-sm mb-6",children:t.content}),(s?.authority==="admin"||s?.authority==="instructor")&&e.jsxs(W,{className:"flex justify-end gap-2",children:[e.jsxs(v,{variant:"outline",size:"sm",onClick:()=>{console.log("edit notice")},children:[e.jsx(Me,{className:"w-4 h-4 mr-1"}),"修正"]}),e.jsxs(v,{variant:"destructive",size:"sm",onClick:o,children:[e.jsx(Le,{className:"w-4 h-4 mr-1"}),"削除"]})]})]})})})}function it(){const t=w(y),[{data:r,isPending:s}]=H(Qe),[n,o]=l.useState(null);return s?e.jsx(Be,{}):e.jsxs(e.Fragment,{children:[e.jsxs(fe,{className:"w-1/3 max-w-1/3",children:[e.jsxs(ge,{className:"flex flex-row items-center justify-between",children:[e.jsx(ve,{children:"Notice"}),(t?.authority==="admin"||t?.authority==="instructor")&&e.jsx(at,{})]}),e.jsx(je,{children:e.jsx(ke,{className:"h-50 pr-4",children:e.jsxs("ul",{className:"space-y-3",children:[r?.map(a=>e.jsxs("li",{onClick:()=>o(a),className:"cursor-pointer rounded-md border p-3 hover:bg-muted",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.isImportant&&e.jsx(D,{variant:"destructive",children:"중요"}),a.isNew&&e.jsx(D,{variant:"secondary",children:"NEW"})]}),e.jsx("div",{className:"font-medium",children:a.title}),e.jsx("div",{className:"text-xs text-muted-foreground",children:a.createdAt.toLocaleDateString()})]},a.id)),r?.length===0&&e.jsx("div",{className:"text-sm text-muted-foreground text-center py-10",children:"등록된 공지사항이 없습니다."})]})})})]}),e.jsx(ot,{selectedNotice:n,setSelectedNotice:o})]})}const _="my-8 max-w-1/3";function Rt({}){return[{title:"React Learning by Ryan"},{name:"React Learning",content:"Welcome to React Learning App!"}]}const It=oe(function(){const r=ie(),s=w(y),n=w(ue),o=()=>{if(n){const a=Re(n);a&&r(`/contents/${a}`)}};return s?n?e.jsxs("main",{className:"p-8 flex flex-col justify-center items-center gap-2",children:[e.jsxs("h1",{className:`${De} flex items-center gap-3 tracking-wide`,children:[e.jsx(Ne,{id:"react-icon",className:"text-blue-600 animate-spin"}),e.jsx("span",{children:"React Learning"})]}),e.jsx(A,{className:_}),s&&e.jsxs(e.Fragment,{children:[e.jsxs("h3",{className:`${Fe}`,children:["ようこそ ",s?.name,"さん!"]}),e.jsx(Ye,{})]}),e.jsx(A,{className:_}),e.jsx(it,{}),e.jsx(A,{className:_}),e.jsxs($,{className:"gap-2",children:[e.jsxs(v,{onClick:o,children:[e.jsx(Oe,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:"React学習"})]}),e.jsxs(v,{onClick:()=>r("/community"),children:[e.jsx(He,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:"コミュニティ"})]})]})]}):e.jsx("main",{className:"p-8 flex flex-col justify-center items-center gap-2",children:e.jsx("p",{children:"コンテンツを読み込み中..."})}):e.jsx(ce,{to:"/login",replace:!0})});export{It as default,Rt as meta};
